<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>Paycheck Tracker v42.1</title>
<style>
body{font-family:-apple-system,Arial;background:#FFF8F0;margin:0}
header{text-align:center;font-size:26px;padding:12px}
.monthNav, .dashboard{display:flex;justify-content:center;gap:6px}
.monthNav button,select,.btn{background:#FFD6A5;border:none;border-radius:8px;padding:6px}
#calendarWrap{width:230px;margin:auto}
#miniCalendar{width:100%;border-collapse:collapse}
#miniCalendar td,#miniCalendar th{border:1px solid #ccc;text-align:center;height:30px;font-size:11px;border-radius:4px;cursor:pointer}
.today{border:2px solid #FFB347;box-shadow:0 0 5px #FFD580}
.selected{border:2px solid #FFB347}
#calendarInfo{background:#FFF3E0;padding:6px;margin-top:4px;border-radius:6px;font-size:12px}
.section{margin:12px}
table{width:100%;border-collapse:collapse;box-shadow:0 2px 6px rgba(0,0,0,.1)}
th,td{border:1px solid #ccc;font-size:12px;text-align:center;padding:4px}
tbody{display:block;max-height:180px;overflow:auto}
thead,tr{display:table;width:100%;table-layout:fixed}
input,select{width:95%;font-size:11px}
.remove{background:#FFB3B3;border:none;border-radius:6px}
.blue{background:#1E88E5}.red{background:#E53935}.purple{background:#A569BD}
</style>
</head>

<body>
<header>ðŸ’° Paycheck Tracker</header>

<div id="calendarWrap">
  <div class="monthNav">
    <button id="prev">â—€</button>
    <select id="month"></select>
    <select id="year"></select>
    <button id="next">â–¶</button>
    <button id="today">Today</button>
  </div>
  <table id="miniCalendar">
    <thead><tr><th>Su</th><th>Mo</th><th>Tu</th><th>We</th><th>Th</th><th>Fr</th><th>Sa</th></tr></thead>
    <tbody></tbody>
  </table>
  <div id="calendarInfo">Select a day</div>
</div>

<div class="dashboard">
  <div>Income: $<span id="dIncome">0</span></div>
  <div>Bills: $<span id="dBills">0</span></div>
  <div>Left: $<span id="dLeft">0</span></div>
</div>

<div style="padding:12px">
  <canvas id="monthChart" height="140"></canvas>
  <button class="btn" onclick="exportCSV()">Export CSV</button>
</div>

<div class="section">
<h3>Income</h3>
<button class="btn" onclick="addIncome()">âž• Add Income</button>
<button class="btn" onclick="sortIncome()">Sort</button>
<table>
<thead><tr><th>Type</th><th>Date</th><th>Expected</th><th>Actual</th><th></th></tr></thead>
<tbody id="incomeBody"></tbody>
</table>
</div>

<div class="section">
<h3>Bills</h3>
<button class="btn" onclick="addBill()">âž• Add Bill</button>
<button class="btn" onclick="sortBills()">Sort</button>
<table>
<thead><tr><th>Name</th><th>Due</th><th>Amount</th><th>Paid</th><th></th></tr></thead>
<tbody id="billBody"></tbody>
</table>
</div>

<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script>
function renderChart(){
  if(window.chart) window.chart.destroy();
  window.chart=new Chart(monthChart,{
    type:'bar',
    data:{
      labels:['Income','Bills'],
      datasets:[{
        data:[
          Number(dIncome.textContent),
          Number(dBills.textContent)
        ],
        backgroundColor:['#4F9DDE','#E57373'],
        borderRadius:8
      }]
    },
    options:{
      plugins:{legend:{display:false}},
      scales:{y:{beginAtZero:true}}
    }
  });
}

function exportCSV(){
  let rows=[["Type","Name","Date","Amount"]];
  incomes.forEach(i=>rows.push(["Income",i.type,i.date,i.actual]));
  bills.forEach(b=>rows.push(["Bill",b.name,b.date,b.amount]));
  const csv=rows.map(r=>r.join(",")).join("\n");
  const a=document.createElement("a");
  a.href=URL.createObjectURL(new Blob([csv],{type:"text/csv"}));
  a.download="paycheck-tracker.csv";
  a.click();
}
</script>

<script>
const $=id=>document.getElementById(id);
const iso=(y,m,d)=>`${y}-${String(m+1).padStart(2,0)}-${String(d).padStart(2,0)}`;
const parse=d=>d?new Date(d):null;

let incomes=JSON.parse(localStorage.incomes||"[]");
let bills=JSON.parse(localStorage.bills||"[]");
let cur=new Date(), sel=cur.getDate();

function save(){localStorage.incomes=JSON.stringify(incomes);localStorage.bills=JSON.stringify(bills)}

for(let i=0;i<12;i++)month.add(new Option(new Date(0,i).toLocaleString('default',{month:'short'}),i));
for(let y=cur.getFullYear()-3;y<=cur.getFullYear()+3;y++)year.add(new Option(y,y));
month.value=cur.getMonth(); year.value=cur.getFullYear();

prev.onclick=()=>{cur.setMonth(cur.getMonth()-1);render()};
next.onclick=()=>{cur.setMonth(cur.getMonth()+1);render()};
today.onclick=()=>{cur=new Date();sel=cur.getDate();render()};
month.onchange=()=>{cur.setMonth(month.value);render()};
year.onchange=()=>{cur.setFullYear(year.value);render()};

function renderCalendar(){
  const b=$("miniCalendar").tBodies[0]; b.innerHTML="";
  const y=cur.getFullYear(),m=cur.getMonth();
  const first=new Date(y,m,1).getDay(), last=new Date(y,m+1,0).getDate();
  let r=b.insertRow(); for(let i=0;i<first;i++)r.insertCell();
  for(let d=1;d<=last;d++){
    if(r.cells.length===7)r=b.insertRow();
    const c=r.insertCell(); c.textContent=d;
    const ds=iso(y,m,d);
    const i=incomes.some(x=>x.date===ds);
    const bl=bills.some(x=>x.date===ds);
    if(i&&bl)c.className="purple"; else if(i)c.className="blue"; else if(bl)c.className="red";
    if(d===sel)c.classList.add("selected");
    if(d===new Date().getDate()&&m===new Date().getMonth()&&y===new Date().getFullYear())c.classList.add("today");
    c.onclick=()=>{sel=d;render()};
  }
}

function calendarInfo(){
  const ds=iso(cur.getFullYear(),cur.getMonth(),sel);
  const inc=incomes.filter(i=>i.date===ds);
  const bl=bills.filter(b=>b.date===ds);
  calendarInfo.textContent=inc.length||bl.length
    ? [...inc.map(i=>`Income $${i.actual}`),...bl.map(b=>`Bill $${b.amount}`)].join(" | ")
    : "No entries";
}

function renderTables(){
  incomeBody.innerHTML="";
  incomes.filter(i=>parse(i.date)?.getMonth()===cur.getMonth()).forEach((i,x)=>{
    incomeBody.innerHTML+=`
    <tr>
      <td><select onchange="incomes[${x}].type=this.value;save()"><option ${i.type==="Salary"?"selected":""}>Salary</option><option ${i.type==="Other"?"selected":""}>Other</option></select></td>
      <td><input type="date" value="${i.date}" onchange="incomes[${x}].date=this.value;save();render()"></td>
      <td><input value="${i.expected}" onchange="incomes[${x}].expected=this.value;save();render()"></td>
      <td><input value="${i.actual}" onchange="incomes[${x}].actual=this.value;save();render()"></td>
      <td><button class="remove" onclick="incomes.splice(${x},1);save();render()">ðŸ—‘</button></td>
    </tr>`;
  });
  billBody.innerHTML="";
  bills.filter(b=>parse(b.date)?.getMonth()===cur.getMonth()).forEach((b,x)=>{
    billBody.innerHTML+=`
    <tr>
      <td><input value="${b.name}" onchange="bills[${x}].name=this.value;save()"></td>
      <td><input type="date" value="${b.date}" onchange="bills[${x}].date=this.value;save();render()"></td>
      <td><input value="${b.amount}" onchange="bills[${x}].amount=this.value;save();render()"></td>
      <td><input type="checkbox" ${b.paid?"checked":""} onchange="bills[${x}].paid=this.checked;save()"></td>
      <td><button class="remove" onclick="bills.splice(${x},1);save();render()">ðŸ—‘</button></td>
    </tr>`;
  });
}

function dashboard(){
  const m=cur.getMonth(),y=cur.getFullYear();
  let income=0,bill=0,carry=0;
  incomes.forEach(i=>{const d=parse(i.date); if(d<new Date(y,m,1))carry+=+i.actual; if(d.getMonth()===m&&d.getFullYear()===y)income+=+i.actual});
  bills.forEach(b=>{const d=parse(b.date); if(d<new Date(y,m,1))carry-=+b.amount; if(d.getMonth()===m&&d.getFullYear()===y)bill+=+b.amount});
  dIncome.textContent=(carry+income).toFixed(2);
  dBills.textContent=bill.toFixed(2);
  dLeft.textContent=(carry+income-bill).toFixed(2);
renderChart();
}

function addIncome(){incomes.push({type:"Salary",date:iso(cur.getFullYear(),cur.getMonth(),sel),expected:"0.00",actual:"0.00"});save();render()}
function addBill(){bills.push({name:"",date:iso(cur.getFullYear(),cur.getMonth(),sel),amount:"0.00"});save();render()}
function sortIncome(){incomes.sort((a,b)=>new Date(a.date)-new Date(b.date));save();render()}
function sortBills(){bills.sort((a,b)=>new Date(a.date)-new Date(b.date));save();render()}

function render(){renderCalendar();calendarInfo();renderTables();dashboard()}
render();
</script>
<style>
#calendarWrap{
  width:320px;
  margin:auto;
  position:sticky;
  top:0;
  background:#FFF8F0;
  z-index:10;
}
#miniCalendar td,#miniCalendar th{
  height:40px;
  font-size:14px;
}
table tbody{
  display:table-row-group;
  max-height:none;
  overflow:visible;
}
</style>
</body>
</html>