<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Paycheck Tracker v40 + Mini Calendar</title>
<style>
body{margin:0;font-family:Arial,sans-serif;background:#FDF9F5;color:#333;}
header{padding:12px;font-size:28px;text-align:center;}
.dashboard{display:flex;justify-content:space-around;padding:10px;background:#fff;border-radius:10px;margin:0 10px;}
.monthNav{display:flex;justify-content:center;gap:10px;margin:10px;}
#miniCalendar{border-collapse:collapse;margin:auto;}
#miniCalendar th,#miniCalendar td{width:32px;height:32px;text-align:center;border:1px solid #ccc;}
#miniCalendar td.today{background:#FFD6A5;border-radius:50%;}
.section{margin:10px;}
.section h3{margin:4px 0;}
.card{background:#fff;border-radius:12px;padding:10px;margin:6px 0;box-shadow:0 2px 5px rgba(0,0,0,0.1);}
input[type=text], input[type=number], input[type=date]{width:100%;padding:6px;margin:4px 0;border-radius:6px;border:1px solid #ccc;box-sizing:border-box;}
.addEntryBtn{padding:6px 10px;border-radius:8px;background:#FFD6A5;border:none;cursor:pointer;margin-bottom:6px;}
.switch{position:relative;display:inline-block;width:36px;height:20px;margin-left:4px;}
.switch input{opacity:0;width:0;height:0;}
.slider{position:absolute;cursor:pointer;top:0;left:0;right:0;bottom:0;background-color:#d1d5db;border-radius:24px;transition:0.4s;}
.slider:before{position:absolute;content:"";height:16px;width:16px;left:2px;bottom:2px;background:white;border-radius:50%;transition:0.4s;}
input:checked + .slider{background-color:#B9FBC1;}
input:checked + .slider:before{transform:translateX(16px);}
.progress-container{width:100%;background:#E0E0E0;border-radius:6px;height:8px;margin-top:2px;}
.progress-fill{height:100%;background:#FFD6A5;border-radius:6px;}
</style>
</head>
<body>

<header>ðŸ’° Paycheck Tracker</header>

<div class="dashboard">
  <span id="dashIncome">Income: $0</span>
  <span id="dashBills">Bills: $0</span>
  <span id="dashLeft">Left: $0</span>
  <span id="dashPercent">Received: 0%</span>
</div>

<!-- Mini Calendar -->
<div class="monthNav">
  <select id="monthSelect"></select>
  <select id="yearSelect"></select>
</div>
<div id="miniCalendarContainer">
  <table id="miniCalendar">
    <thead>
      <tr>
        <th>Su</th><th>Mo</th><th>Tu</th><th>We</th><th>Th</th><th>Fr</th><th>Sa</th>
      </tr>
    </thead>
    <tbody></tbody>
  </table>
</div>

<!-- Income Section -->
<div class="section">
<h3>Income</h3>
<button id="addIncomeBtn" class="addEntryBtn">âž• Add Income</button>
<div id="incomeContainer"></div>
</div>

<!-- Bills Section -->
<div class="section">
<h3>Bills</h3>
<button id="addBillBtn" class="addEntryBtn">âž• Add Bill</button>
<div id="billContainer"></div>
</div>

<script>
let incomes=[]; let bills=[];
let currentDate=new Date();

function updateDashboard(){
  let month=incomes.filter(i=>i.date&&new Date(i.date).getMonth()===currentDate.getMonth() && new Date(i.date).getFullYear()===currentDate.getFullYear());
  let billsMonth=bills.filter(b=>b.date&&new Date(b.date).getMonth()===currentDate.getMonth() && new Date(b.date).getFullYear()===currentDate.getFullYear());

  let totalInc=month.reduce((a,b)=>a+(+b.actual||0),0);
  let totalBills=billsMonth.reduce((a,b)=>a+(+b.amount||0),0);
  let paidInc=month.filter(i=>i.paidDate).reduce((a,b)=>a+(+b.actual||0),0);
  let percent=totalInc?Math.round((paidInc/totalInc)*100):0;

  document.getElementById("dashIncome").innerText=`Income: $${totalInc.toFixed(2)}`;
  document.getElementById("dashBills").innerText=`Bills: $${totalBills.toFixed(2)}`;
  document.getElementById("dashLeft").innerText=`Left: $${(paidInc-totalBills).toFixed(2)}`;
  document.getElementById("dashPercent").innerText=`Received: ${percent}%`;
}

// Mini Calendar
function renderMiniCalendar(){
  const tbody=document.querySelector("#miniCalendar tbody"); tbody.innerHTML="";
  const month=currentDate.getMonth(); const year=currentDate.getFullYear();
  const firstDay=new Date(year,month,1).getDay();
  const lastDate=new Date(year,month+1,0).getDate();
  let row=document.createElement("tr");
  for(let i=0;i<firstDay;i++){ row.appendChild(document.createElement("td")); }
  for(let d=1;d<=lastDate;d++){
    const td=document.createElement("td"); td.textContent=d;
    const today=new Date(); if(d===today.getDate() && month===today.getMonth() && year===today.getFullYear()){ td.className="today"; }
    row.appendChild(td); if((firstDay+d)%7===0){ tbody.appendChild(row); row=document.createElement("tr"); }
  }
  tbody.appendChild(row);
}

// Create Income card
function createIncomeCard(i){
  const div=document.createElement("div"); div.className="card";
  const typeInput=document.createElement("input"); typeInput.type="text"; typeInput.value=i.type||"Salary"; typeInput.placeholder="Type (Salary/Other)";
  typeInput.addEventListener("input",e=>{i.type=e.target.value; updateDashboard();});
  const descInput=document.createElement("input"); descInput.type="text"; descInput.value=i.custom||""; descInput.placeholder="Description";
  descInput.addEventListener("input",e=>{i.custom=e.target.value;});
  const expectedInput=document.createElement("input"); expectedInput.type="number"; expectedInput.value=i.expected||0; expectedInput.placeholder="Expected";
  expectedInput.addEventListener("input",e=>{i.expected=parseFloat(e.target.value)||0; updateDashboard();});
  const actualInput=document.createElement("input"); actualInput.type="number"; actualInput.value=i.actual||0; actualInput.placeholder="Actual";
  actualInput.addEventListener("input",e=>{i.actual=parseFloat(e.target.value)||0; updateDashboard();});
  const dateInput=document.createElement("input"); dateInput.type="date"; dateInput.value=i.date||new Date().toISOString().split("T")[0];
  dateInput.addEventListener("input",e=>{i.date=e.target.value; renderEntries();});

  const progress=document.createElement("div"); progress.className="progress-container";
  const fill=document.createElement("div"); fill.className="progress-fill"; fill.style.width=`${i.expected?Math.min(i.actual/i.expected,1)*100:0}%`;
  progress.appendChild(fill);

  const paidLabel=document.createElement("label"); paidLabel.className="switch";
  const paidInput=document.createElement("input"); paidInput.type="checkbox"; paidInput.checked=!!i.paidDate;
  const paidSpan=document.createElement("span"); paidSpan.className="slider";
  paidLabel.appendChild(paidInput); paidLabel.appendChild(paidSpan);
  const paidDateInput=document.createElement("input"); paidDateInput.type="date"; paidDateInput.value=i.paidDate||"";
  paidInput.addEventListener("change",()=>{i.paidDate=paidInput.checked?new Date().toISOString().split("T")[0]:""; paidDateInput.value=i.paidDate; updateDashboard();});
  paidDateInput.addEventListener("input",()=>{i.paidDate=paidDateInput.value; updateDashboard();});

  const removeBtn=document.createElement("button"); removeBtn.textContent="ðŸ—‘ï¸"; removeBtn.addEventListener("click",()=>{incomes.splice(incomes.indexOf(i),1); renderEntries();});

  div.append(typeInput, descInput, dateInput, expectedInput, actualInput, progress, paidLabel, paidDateInput, removeBtn);
  return div;
}

// Create Bill card
function createBillCard(b){
  const div=document.createElement("div"); div.className="card";
  const nameInput=document.createElement("input"); nameInput.type="text"; nameInput.value=b.name||""; nameInput.placeholder="Bill Name";
  nameInput.addEventListener("input",()=>{b.name=nameInput.value;});
  const amountInput=document.createElement("input"); amountInput.type="number"; amountInput.value=b.amount||0; amountInput.placeholder="Amount";
  amountInput.addEventListener("input",()=>{b.amount=parseFloat(amountInput.value)||0; updateDashboard();});
  const dateInput=document.createElement("input"); dateInput.type="date"; dateInput.value=b.date||new Date().toISOString().split("T")[0];
  dateInput.addEventListener("input",()=>{b.date=dateInput.value; renderEntries();});

  const paidLabel=document.createElement("label"); paidLabel.className="switch";
  const paidInput=document.createElement("input"); paidInput.type="checkbox"; paidInput.checked=!!b.paidDate;
  const paidSpan=document.createElement("span"); paidSpan.className="slider";
  paidLabel.appendChild(paidInput); paidLabel.appendChild(paidSpan);
  const paidDateInput=document.createElement("input"); paidDateInput.type="date"; paidDateInput.value=b.paidDate||"";
  paidInput.addEventListener("change",()=>{b.paidDate=paidInput.checked?new Date().toISOString().split("T")[0]:""; paidDateInput.value=b.paidDate; updateDashboard();});
  paidDateInput.addEventListener("input",()=>{b.paidDate=paidDateInput.value; updateDashboard();});

  const removeBtn=document.createElement("button"); removeBtn.textContent="ðŸ—‘ï¸"; removeBtn.addEventListener("click",()=>{bills.splice(bills.indexOf(b),1); renderEntries();});

  div.append(nameInput, dateInput, amountInput, paidLabel, paidDateInput, removeBtn);
  return div;
}

// Render all entries filtered by month
function renderEntries(){
  const incomeC=document.getElementById("incomeContainer"); const billC=document.getElementById("billContainer");
  incomeC.innerHTML=""; billC.innerHTML="";
  incomes.filter(i=>i.date&&new Date(i.date).getMonth()===currentDate.getMonth() && new Date(i.date).getFullYear()===currentDate.getFullYear()).forEach(i=>incomeC.appendChild(createIncomeCard(i)));
  bills.filter(b=>b.date&&new Date(b.date).getMonth()===currentDate.getMonth() && new Date(b.date).getFullYear()===currentDate.getFullYear()).forEach(b=>billC.appendChild(createBillCard(b)));
  updateDashboard(); renderMiniCalendar();
}

// Month/Year dropdowns
const monthSelect=document.getElementById("monthSelect"); const yearSelect=document.getElementById("yearSelect");
for(let m=0;m<12;m++){ let opt=document.createElement("option"); opt.value=m; opt.text=new Date(2000,m,1).toLocaleString('default',{month:'long'}); monthSelect.appendChild(opt);}
for(let y=currentDate.getFullYear()-5;y<=currentDate.getFullYear()+5;y++){ let opt=document.createElement("option"); opt.value=y; opt.text=y; yearSelect.appendChild(opt);}
monthSelect.value=currentDate.getMonth(); yearSelect.value=currentDate.getFullYear();
monthSelect.addEventListener("change",()=>{currentDate.setMonth(parseInt(monthSelect.value)); renderEntries();});
yearSelect.addEventListener("change",()=>{currentDate.setFullYear(parseInt(yearSelect.value)); renderEntries();});

// Add buttons
document.getElementById("addIncomeBtn").addEventListener("click",()=>{incomes.push({type:"Salary",expected:0,actual:0,paidDate:"",custom:"",date:new Date().toISOString().split("T")[0]}); renderEntries();});
document.getElementById("addBillBtn").addEventListener("click",()=>{bills.push({name:"Bill",amount:0,paidDate:"",date:new Date().toISOString().split("T")[0]}); renderEntries();});

renderEntries();
</script>
</body>
</html>