<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Paycheck Tracker v41+ Calendar</title>
<style>
:root{
  --bg:#FDF9F5; --text:#333; --accent:#FFD6A5;
  --salary:#A0E7E5; --other:#FFAEBC; --bill:#FFDAC1; --paid:#FFF4C1;
  --border:#E0E0E0; --progress-bg:#E0E0E0; --progress-fill:#FFD6A5;
}
body{margin:0; font-family:-apple-system,BlinkMacSystemFont,"SF Pro"; background:var(--bg); color:var(--text);}
header{padding:12px; font-size:28px; font-weight:700; text-align:center;}
.dashboard{display:flex; justify-content:space-around; font-weight:700; padding:10px 0; background:#fff; border-radius:14px; box-shadow:0 3px 6px rgba(0,0,0,0.1); margin:0 10px 10px;}
.monthNav{display:flex; justify-content:center; align-items:center; gap:10px; margin:0 10px 10px;}
.monthLabel{font-size:24px; font-weight:700;}
.monthGrid{display:grid; grid-template-columns:repeat(3,1fr); gap:6px; margin:0 10px 10px;}
.monthBox{padding:8px 0; text-align:center; background:#fff; border-radius:12px; cursor:pointer; box-shadow:0 2px 4px rgba(0,0,0,0.1); transition:0.15s;}
.monthBox:hover{background:var(--accent);}
.section{margin:10px;}
.section h3{margin:4px 0;}
.entry{background:#fff; border-radius:10px; padding:6px; margin:4px 0; box-shadow:0 2px 4px rgba(0,0,0,0.08); cursor:pointer;}
.entry.expanded{background:#F2F2F7;}
.entry input[type=text], .entry input[type=number], .entry input[type=date]{width:100%; padding:4px; margin:2px 0; font-size:14px; border-radius:6px; border:1px solid #ccc; box-sizing:border-box;}
.addEntryBtn{padding:4px 8px; margin:4px 0; border-radius:8px; background:var(--accent); border:none; cursor:pointer; font-size:14px;}
.switch{position:relative; display:inline-block; width:36px; height:20px;}
.switch input{opacity:0; width:0; height:0;}
.slider{position:absolute; cursor:pointer; top:0; left:0; right:0; bottom:0; background-color:#d1d5db; border-radius:24px; transition:0.4s;}
.slider:before{position:absolute; content:""; height:16px; width:16px; left:2px; bottom:2px; background:white; border-radius:50%; transition:0.4s;}
input:checked + .slider{background-color:#B9FBC1;}
input:checked + .slider:before{transform:translateX(16px);}
.progress-container{width:100%; background:var(--progress-bg); border-radius:6px; height:8px; margin-top:2px;}
.progress-fill{height:100%; background:var(--progress-fill); border-radius:6px;}
</style>
</head>
<body>

<header>ðŸ’° Paycheck Tracker</header>
<div class="dashboard">
  <span id="dashIncome">Income: $0.00</span>
  <span id="dashBills">Bills: $0.00</span>
  <span id="dashLeft">Left: $0.00</span>
  <span id="dashPercent">Received: 0%</span>
</div>

<div class="monthNav">
  <button id="prevMonth">&lt;</button>
  <div class="monthLabel" id="monthLabel"></div>
  <button id="nextMonth">&gt;</button>
</div>

<div class="monthGrid" id="monthGrid"></div>

<div class="section">
<h3>Income</h3>
<button id="addIncomeBtn" class="addEntryBtn">âž• Add Income</button>
<div id="incomeContainer"></div>
</div>

<div class="section">
<h3>Bills</h3>
<button id="addBillBtn" class="addEntryBtn">âž• Add Bill</button>
<div id="billContainer"></div>
</div>

<script>
document.addEventListener("DOMContentLoaded",()=>{

let incomes=JSON.parse(localStorage.getItem("incomes"))||[];
let bills=JSON.parse(localStorage.getItem("bills"))||[];
let currentDate=new Date();

const save=()=>{localStorage.setItem("incomes",JSON.stringify(incomes)); localStorage.setItem("bills",JSON.stringify(bills));}
const fmt=v=>`$${(parseFloat(v)||0).toFixed(2)}`;

function formatMonthYear(date){return date.toLocaleString('default',{month:'long',year:'numeric'});}
function getMonthString(date){return `${date.getFullYear()}-${(date.getMonth()+1).toString().padStart(2,'0')}`;}

function updateDashboard(){
const monthStr=getMonthString(currentDate);
const totalInc=incomes.filter(i=>i.date.startsWith(monthStr)).reduce((t,i)=>t+(+i.actual||0),0);
const totalBills=bills.filter(b=>b.due.startsWith(monthStr)).reduce((t,b)=>t+(+b.amount||0),0);
const paidInc=incomes.filter(i=>i.paidDate && i.date.startsWith(monthStr)).reduce((t,i)=>t+(+i.actual||0),0);
const percent=totalInc?Math.round((paidInc/totalInc)*100):0;
document.getElementById("dashIncome").innerText=`Income: ${fmt(totalInc)}`;
document.getElementById("dashBills").innerText=`Bills: ${fmt(totalBills)}`;
document.getElementById("dashLeft").innerText=`Left: ${fmt(paidInc-totalBills)}`;
document.getElementById("dashPercent").innerText=`Received: ${percent}%`;
}

function createIncomeEntry(i){
  const div=document.createElement("div"); div.className="entry"; div.innerText=`${i.type} ${fmt(i.actual||0)}`;
  div.addEventListener("click",()=>{
    if(div.classList.contains("expanded")){div.classList.remove("expanded"); div.innerText=`${i.type} ${fmt(i.actual||0)}`; return;}
    div.classList.add("expanded"); div.innerHTML="";
    const typeInput=document.createElement("input"); typeInput.type="text"; typeInput.value=i.type; typeInput.readOnly=true;
    typeInput.style.background=i.type==='Salary'? '#A0E7E5':'#FFAEBC';
    const descInput=document.createElement("input"); descInput.type="text"; descInput.value=i.custom||""; descInput.placeholder="Description";
    descInput.addEventListener("input",e=>{i.custom=e.target.value; save();});
    const expectedInput=document.createElement("input"); expectedInput.type="text"; expectedInput.value=i.expected||0; expectedInput.placeholder="Expected";
    expectedInput.addEventListener("input",e=>e.target.value=e.target.value.replace(/[^0-9.]/g,''));
    expectedInput.addEventListener("blur",()=>{i.expected=parseFloat(expectedInput.value)||0; save(); updateDashboard();});
    const actualInput=document.createElement("input"); actualInput.type="text"; actualInput.value=i.actual||0; actualInput.placeholder="Actual";
    actualInput.addEventListener("input",e=>e.target.value=e.target.value.replace(/[^0-9.]/g,''));
    actualInput.addEventListener("blur",()=>{i.actual=parseFloat(actualInput.value)||0; save(); updateDashboard();});
    const progress=document.createElement("div"); progress.className="progress-container";
    const fill=document.createElement("div"); fill.className="progress-fill"; fill.style.width=`${i.expected?Math.min((i.actual||0)/i.expected,1)*100:0}%`;
    progress.appendChild(fill);
    const switchLabel=document.createElement("label"); switchLabel.className="switch";
    const switchInput=document.createElement("input"); switchInput.type="checkbox"; switchInput.checked=!!i.paidDate;
    const switchSpan=document.createElement("span"); switchSpan.className="slider";
    switchLabel.appendChild(switchInput); switchLabel.appendChild(switchSpan);
    const datePaidInput=document.createElement("input"); datePaidInput.type="date"; datePaidInput.value=i.paidDate||"";
    switchInput.addEventListener("change",()=>{if(switchInput.checked){const today=new Date().toISOString().split("T")[0]; i.paidDate=today; datePaidInput.value=today;}else{i.paidDate=""; datePaidInput.value="";} save(); renderEntries();});
    datePaidInput.addEventListener("input",()=>{i.paidDate=datePaidInput.value; save();});
    const removeBtn=document.createElement("button"); removeBtn.textContent="ðŸ—‘ï¸";
    removeBtn.addEventListener("click",()=>{incomes.splice(incomes.indexOf(i),1); save(); renderEntries();});
    div.append(typeInput, descInput, expectedInput, actualInput, progress, switchLabel, datePaidInput, removeBtn);
  });
  return div;
}

function createBillEntry(b){
  const div=document.createElement("div"); div.className="entry"; div.innerText=`${b.name||"Bill"} ${fmt(b.amount||0)}`;
  div.addEventListener("click",()=>{
    if(div.classList.contains("expanded")){div.classList.remove("expanded"); div.innerText=`${b.name||"Bill"} ${fmt(b.amount||0)}`; return;}
    div.classList.add("expanded"); div.innerHTML="";
    const nameInput=document.createElement("input"); nameInput.type="text"; nameInput.value=b.name||""; nameInput.placeholder="Bill Name";
    nameInput.addEventListener("input",()=>{b.name=nameInput.value; save();});
    const amountInput=document.createElement("input"); amountInput.type="text"; amountInput.value=b.amount||0; amountInput.placeholder="Amount";
    amountInput.addEventListener("input",e=>e.target.value=e.target.value.replace(/[^0-9.]/g,''));
    amountInput.addEventListener("blur",()=>{b.amount=parseFloat(amountInput.value)||0; save(); updateDashboard();});
    const switchLabel=document.createElement("label"); switchLabel.className="switch";
    const switchInput=document.createElement("input"); switchInput.type="checkbox"; switchInput.checked=!!b.paidDate;
    const switchSpan=document.createElement("span"); switchSpan.className="slider";
    switchLabel.appendChild(switchInput); switchLabel.appendChild(switchSpan);
    const datePaidInput=document.createElement("input"); datePaidInput.type="date"; datePaidInput.value=b.paidDate||"";
    switchInput.addEventListener("change",()=>{if(switchInput.checked){const today=new Date().toISOString().split("T")[0]; b.paidDate=today; datePaidInput.value=today;}else{b.paidDate=""; datePaidInput.value="";} save(); renderEntries();});
    datePaidInput.addEventListener("input",()=>{b.paidDate=datePaidInput.value; save();});
    const removeBtn=document.createElement("button"); removeBtn.textContent="ðŸ—‘ï¸";
    removeBtn.addEventListener("click",()=>{bills.splice(bills.indexOf(b),1); save(); renderEntries();});
    div.append(nameInput, amountInput, switchLabel, datePaidInput, removeBtn);
  });
  return div;
}

function renderEntries(){
  const monthStr=getMonthString(currentDate);
  document.getElementById("monthLabel").innerText=formatMonthYear(currentDate);
  const incomeContainer=document.getElementById("incomeContainer");
  const billContainer=document.getElementById("billContainer");
  incomeContainer.innerHTML=""; billContainer.innerHTML="";
  incomes.filter(i=>i.date.startsWith(monthStr)).forEach(i=>incomeContainer.appendChild(createIncomeEntry(i)));
  bills.filter(b=>b.due.startsWith(monthStr)).forEach(b=>billContainer.appendChild(createBillEntry(b)));
  updateDashboard();
}

// Month navigation buttons
document.getElementById("prevMonth").addEventListener("click",()=>{currentDate.setMonth(currentDate.getMonth()-1); renderEntries();});
document.getElementById("nextMonth").addEventListener("click",()=>{currentDate.setMonth(currentDate.getMonth()+1); renderEntries();});

// Month grid (year overview)
function renderMonthGrid(){
  const monthGrid=document.getElementById("monthGrid");
  monthGrid.innerHTML="";
  for(let m=0;m<12;m++){
    const box=document.createElement("div"); box.className="monthBox"; box.textContent=new Date(currentDate.getFullYear(),m,1).toLocaleString('default',{month:'short'});
    box.addEventListener("click",()=>{currentDate.setMonth(m); renderEntries();});
    monthGrid.appendChild(box);
  }
}

renderMonthGrid();

// Add buttons
document.getElementById("addIncomeBtn").addEventListener("click", () => {
  const monthStr = getMonthString(currentDate);
  const newDate = `${monthStr}-01`;
  incomes.push({ type: "Salary", custom: "", expected: 0, actual: 0, paidDate: "", date: newDate });
  save(); renderEntries();
});
document.getElementById("addBillBtn").addEventListener("click", () => {
  const monthStr = getMonthString(currentDate);
  const newDate = `${monthStr}-01`;
  bills.push({ name: "", amount: 0, due: newDate, paidDate: "" });
  save(); renderEntries();
});

renderEntries();
});
</script>
</body>
</html>