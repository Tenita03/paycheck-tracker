<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Paycheck Tracker VS40 Table + Calendar</title>
<style>
body { font-family: Arial,sans-serif; background:#FDF9F5; margin:0; padding:0;}
header { text-align:center; font-size:28px; padding:12px; }

.monthNav { display:flex; justify-content:center; gap:10px; margin:10px; }

#miniCalendar { border-collapse:collapse; margin:auto; }
#miniCalendar th,#miniCalendar td { width:40px; height:40px; text-align:center; border:1px solid #ccc; font-size:16px; cursor:pointer; }
#miniCalendar td.today { background:#FFD6A5; border-radius:50%; }
#miniCalendar td.selected { background:#FFB347; border-radius:50%; }

.dashboard { display:flex; justify-content:space-around; align-items:center; background:#FFF3E0; padding:10px; margin:10px; border-radius:10px; font-size:16px; }
.progress-container { width:80%; height:10px; background:#E0E0E0; border-radius:6px; overflow:hidden; margin-top:4px; }
.progress-fill { height:100%; background:#FFB347; width:0%; transition:width 0.3s; }

.section { margin:10px; }
table { width:100%; border-collapse:collapse; }
table tbody { display:block; max-height:220px; overflow-y:auto; }
table thead, table tbody tr { display:table; width:100%; table-layout:fixed; }
th, td { border:1px solid #ccc; padding:8px; font-size:14px; text-align:center; height:36px; }

.addEntryBtn { font-size:15px; padding:8px 12px; border-radius:12px; background:#FFD6A5; border:none; cursor:pointer; margin:6px 0; }
button.removeBtn { background:#FF6B6B; color:white; border:none; border-radius:6px; padding:4px 8px; cursor:pointer; font-size:12px; }

.switch { position:relative; display:inline-block; width:36px; height:20px; }
.switch input { opacity:0; width:0; height:0; }
.slider { position:absolute; cursor:pointer; top:0; left:0; right:0; bottom:0; background-color:#d1d5db; border-radius:24px; transition:0.4s; }
.slider:before { position:absolute; content:""; height:16px; width:16px; left:2px; bottom:2px; background:white; border-radius:50%; transition:0.4s; }
input:checked + .slider { background-color:#B9FBC1; }
input:checked + .slider:before { transform:translateX(16px); }
</style>
</head>
<body>

<header>üí∞ Paycheck Tracker</header>

<div class="monthNav">
  <select id="monthSelect"></select>
  <select id="yearSelect"></select>
</div>

<div id="miniCalendarContainer">
  <table id="miniCalendar">
    <thead>
      <tr>
        <th>Su</th><th>Mo</th><th>Tu</th><th>We</th><th>Th</th><th>Fr</th><th>Sa</th>
      </tr>
    </thead>
    <tbody></tbody>
  </table>
</div>

<div class="dashboard">
  <div>Total Income: $<span id="dashIncome">0</span></div>
  <div>Total Bills: $<span id="dashBills">0</span></div>
  <div>Left: $<span id="dashLeft">0</span></div>
  <div>Received:
    <div class="progress-container">
      <div class="progress-fill" id="dashProgress"></div>
    </div>
  </div>
</div>

<div class="section">
<h3>Income</h3>
<button id="addIncomeBtn" class="addEntryBtn">‚ûï Add Income</button>
<table id="incomeTable">
<thead>
<tr>
<th>Type</th><th>Description</th><th>Date</th><th>Actual</th><th>Expected</th><th>Paid</th><th>Date Paid</th><th>Remove</th>
</tr>
</thead>
<tbody></tbody>
</table>
</div>

<div class="section">
<h3>Bills</h3>
<button id="addBillBtn" class="addEntryBtn">‚ûï Add Bill</button>
<table id="billTable">
<thead>
<tr>
<th>Bill Name</th><th>Date Due</th><th>Amount</th><th>Paid</th><th>Date Paid</th><th>Remove</th>
</tr>
</thead>
<tbody></tbody>
</table>
</div>

<script>
// --- Data Storage ---
let incomes = JSON.parse(localStorage.getItem("incomes"))||[];
let bills = JSON.parse(localStorage.getItem("bills"))||[];
let currentDate = new Date();
let selectedDay = null;

// --- Month/Year dropdowns ---
const monthSelect=document.getElementById("monthSelect");
const yearSelect=document.getElementById("yearSelect");
for(let m=0;m<12;m++){ let opt=document.createElement("option"); opt.value=m; opt.text=new Date(2000,m,1).toLocaleString('default',{month:'long'}); monthSelect.appendChild(opt);}
for(let y=currentDate.getFullYear()-5;y<=currentDate.getFullYear()+5;y++){ let opt=document.createElement("option"); opt.value=y; opt.text=y; yearSelect.appendChild(opt);}
monthSelect.value=currentDate.getMonth();
yearSelect.value=currentDate.getFullYear();
monthSelect.onchange=()=>{currentDate.setMonth(parseInt(monthSelect.value)); selectedDay=null; render();}
yearSelect.onchange=()=>{currentDate.setFullYear(parseInt(yearSelect.value)); selectedDay=null; render();}

// --- Mini Calendar ---
function renderMiniCalendar(){
    const tbody=document.querySelector("#miniCalendar tbody"); tbody.innerHTML="";
    const month=currentDate.getMonth(), year=currentDate.getFullYear();
    const firstDay=new Date(year,month,1).getDay();
    const lastDate=new Date(year,month+1,0).getDate();
    let row=document.createElement("tr");
    for(let i=0;i<firstDay;i++){ row.appendChild(document.createElement("td")); }
    for(let d=1; d<=lastDate; d++){
        const td=document.createElement("td"); td.textContent=d;
        if(d===new Date().getDate() && month===new Date().getMonth() && year===new Date().getFullYear()) td.classList.add("today");
        if(d===selectedDay) td.classList.add("selected");
        td.onclick=()=>{ selectedDay=d; render(); }
        row.appendChild(td);
        if((firstDay+d)%7===0){ tbody.appendChild(row); row=document.createElement("tr"); }
    }
    tbody.appendChild(row);
}

// --- Dashboard ---
function updateDashboard(){
    const filterFunc = e=>!selectedDay || new Date(e.date).getDate()===selectedDay;
    const filteredIncomes = incomes.filter(filterFunc);
    const filteredBills = bills.filter(filterFunc);
    const totalIncome = filteredIncomes.reduce((sum,i)=>sum+(+i.actual||0),0);
    const totalExpected = filteredIncomes.reduce((sum,i)=>sum+(+i.expected||0),0);
    const totalBills = filteredBills.reduce((sum,b)=>sum+(+b.amount||0),0);
    const receivedPercent = totalExpected ? Math.min((totalIncome/totalExpected)*100,100) : 0;
    document.getElementById("dashIncome").innerText = totalIncome.toFixed(2);
    document.getElementById("dashBills").innerText = totalBills.toFixed(2);
    document.getElementById("dashLeft").innerText = (totalIncome-totalBills).toFixed(2);
    document.getElementById("dashProgress").style.width = receivedPercent + "%";
}

// --- LocalStorage ---
function saveData(){ localStorage.setItem("incomes",JSON.stringify(incomes)); localStorage.setItem("bills",JSON.stringify(bills)); }

// --- Render Tables ---
function render(){
    renderMiniCalendar();
    updateDashboard();
    const filterFunc = e=>!selectedDay || new Date(e.date).getDate()===selectedDay;

    // Income table
    const incBody=document.querySelector("#incomeTable tbody"); incBody.innerHTML="";
    incomes.forEach((i,index)=>{
        if(filterFunc(i)){
            const tr=document.createElement("tr");
            tr.innerHTML=`
            <td><input type="text" value="${i.type||'Salary'}" onchange="incomes[${index}].type=this.value; saveData(); render();"></td>
            <td><input type="text" value="${i.description||''}" onchange="incomes[${index}].description=this.value; saveData(); render();"></td>
            <td><input type="date" value="${i.date||new Date().toISOString().split('T')[0]}" onchange="incomes[${index}].date=this.value; saveData(); render();"></td>
            <td><input type="number" value="${i.actual||0}" onchange="incomes[${index}].actual=parseFloat(this.value)||0; saveData(); render();"></td>
            <td><input type="number" value="${i.expected||0}" onchange="incomes[${index}].expected=parseFloat(this.value)||0; saveData(); render();"></td>
            <td><label class="switch"><input type="checkbox" ${i.paidDate?'checked':''} onchange="incomes[${index}].paidDate=this.checked?new Date().toISOString().split('T')[0]:''; saveData(); render();"><span class="slider"></span></label></td>
            <td><input type="date" value="${i.paidDate||''}" onchange="incomes[${index}].paidDate=this.value; saveData(); render();"></td>
            <td><button class="removeBtn" onclick="incomes.splice(${index},1); saveData(); render();">üóëÔ∏è</button></td>`;
            incBody.appendChild(tr);
        }
    });

    // Bills table
    const billBody=document.querySelector("#billTable tbody"); billBody.innerHTML="";
    bills.forEach((b,index)=>{
        if(filterFunc(b)){
            const tr=document.createElement("tr");
            tr.innerHTML=`
            <td><input type="text" value="${b.name||''}" onchange="bills[${index}].name=this.value; saveData(); render();"></td>
            <td><input type="date" value="${b.date||new Date().toISOString().split('T')[0]}" onchange="bills[${index}].date=this.value; saveData(); render();"></td>
            <td><input type="number" value="${b.amount||0}" onchange="bills[${index}].amount=parseFloat(this.value)||0; saveData(); render();"></td>
            <td><label class="switch"><input type="checkbox" ${b.paidDate?'checked':''} onchange="bills[${index}].paidDate=this.checked?new Date().toISOString().split('T')[0]:''; saveData(); render();"><span class="slider"></span></label></td>
            <td><input type="date" value="${b.paidDate||''}" onchange="bills[${index}].paidDate=this.value; saveData(); render();"></td>
            <td><button class="removeBtn" onclick="bills.splice(${index},1); saveData(); render();">üóëÔ∏è</button></td>`;
            billBody.appendChild(tr);
        }
    });
}

// --- Add buttons ---
document.getElementById("addIncomeBtn").onclick=()=>{
    const dateStr = selectedDay ? new Date(currentDate.getFullYear(), currentDate.getMonth(), selectedDay).toISOString().split('T')[0]
                                : new Date().toISOString().split('T')[0];
    incomes.push({type:'Salary',description:'',date:dateStr,actual:0,expected:0,paidDate:''});
    saveData(); render();
};
document.getElementById("addBillBtn").onclick=()=>{
    const dateStr = selectedDay ? new Date(currentDate.getFullYear(), currentDate.getMonth(), selectedDay).toISOString().split('T')[0]
                                : new Date().toISOString().split('T')[0];
    bills.push({name:'Bill',date:dateStr,amount:0,paidDate:''});
    saveData(); render();
};

// Initial render
render();
</script>
</body>
</html>